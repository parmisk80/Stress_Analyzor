import random

class StressRecommender:
    def __init__(self):
        self.recommendations = {
            "خشم": {
                "کتاب‌ها": [
                    "هوش هیجانی – دانیل گلمن",
                    "مدیریت خشم – رونالد پاتر اف"
                ],
                "فیلم‌ها": [
                    "The Pursuit of Happyness (2006)",
                    "Inside Out (2015)"
                ],
                "تمرین‌ها": [
                    "تمرین تنفس عمیق در ۴ ثانیه",
                    "نوشتن احساسات بدون سانسور به مدت ۵ دقیقه"
                ]
            },
            "اضطراب": {
                "کتاب‌ها": [
                    "هنر آرامش در دنیای پرتنش – برایان لوکاس",
                    "ذهن‌آگاهی برای مبتدیان – جان کابات زین"
                ],
                "فیلم‌ها": [
                    "A Beautiful Mind (2001)",
                    "Soul (2020)"
                ],
                "تمرین‌ها": [
                    "مدیتیشن ۱۰ دقیقه‌ای هر روز صبح",
                    "پیاده‌روی آرام در طبیعت یا پارک"
                ]
            },
            "غم": {
                "کتاب‌ها": [
                    "انسان در جست‌وجوی معنا – ویکتور فرانکل",
                    "قدرت حال – اکهارت توله"
                ],
                "فیلم‌ها": [
                    "Good Will Hunting (1997)",
                    "The Secret Life of Walter Mitty (2013)"
                ],
                "تمرین‌ها": [
                    "نوشتن سه مورد مثبت از روز خود هر شب",
                    "صحبت با یک دوست نزدیک یا درمانگر"
                ]
            },
            "خوشحالی": {
                "کتاب‌ها": [
                    "راز شاد زیستن – اندرو متیوس",
                    "عادت‌های اتمی – جیمز کلیر"
                ],
                "فیلم‌ها": [
                    "Yes Man (2008)",
                    "The Intern (2015)"
                ],
                "تمرین‌ها": [
                    "تمرکز روی قدردانی روزانه",
                    "انجام کارهای داوطلبانه کوچک"
                ]
            },
            "ترس": {
                "کتاب‌ها": [
                    "رو‌به‌رو شدن با ترس – سوزان جفرز",
                    "شجاعت درونی – برنه براون"
                ],
                "فیلم‌ها": [
                    "Life of Pi (2012)",
                    "Cast Away (2000)"
                ],
                "تمرین‌ها": [
                    "نوشتن بزرگ‌ترین ترس‌ها و راهکار مقابله",
                    "تکنیک توقف افکار منفی با گفتن “ایست!” در ذهن"
                ]
            }
        }

    def recommend(self, analysis_result):
        main_emotion = analysis_result["main_emotion"]
        stress_level = analysis_result["stress_level"]

        if main_emotion not in self.recommendations:
            main_emotion = "خوشحالی" 

        rec = self.recommendations[main_emotion]

        
        if stress_level > 3.5:
            extra = "پیشنهاد می‌شود روزانه زمانی را به مراقبه و ورزش سبک اختصاص دهید."
        elif stress_level > 2:
            extra = "بهتر است خواب کافی و برنامه‌ی استراحت منظمی داشته باشید."
        else:
            extra = "شرایط احساسی‌تان پایدار به نظر می‌رسد، با همین روند ادامه دهید!"

    
        return {
            "احساس اصلی": main_emotion,
            "سطح استرس": f"{stress_level:.1f}/5",
            "کتاب پیشنهادی": random.choice(rec["کتاب‌ها"]),
            "فیلم پیشنهادی": random.choice(rec["فیلم‌ها"]),
            "تمرین آرام‌سازی": random.choice(rec["تمرین‌ها"]),
            "توصیه‌ی تکمیلی": extra
        }